<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Calcul symbolique exact</title>

<!-- Nerdamer (core + modules) -->
<script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.13/nerdamer.core.js"></script>
<script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.13/Algebra.js"></script>
<script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.13/Calculus.js"></script>
<script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.13/Solve.js"></script>
<script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.13/Extra.js"></script>

<!-- KaTeX -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>

<style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    input { width: 280px; padding: 6px; font-size: 16px; }
    button { padding: 8px 20px; font-size: 16px; margin-top: 10px; }
    .box { margin-top: 20px; padding: 15px; border: 1px solid #bbb; border-radius: 8px; background:#f8f8f8; }
    .math { font-size: 22px; }
</style>
</head>

<body>

<h2>Calcul exact de \( \sqrt{a^2 + b^2 - 2ab\cos(\alpha)} \)</h2>

<p>a = <input id="aVal" placeholder="ex : 10*sqrt(2)"></p>
<p>b = <input id="bVal" placeholder="ex : 5*sqrt(3)"></p>
<p>α = <input id="alphaVal" placeholder="ex : pi/5, 3*pi/10, 2*pi/3"></p>

<button onclick="compute()">Calculer</button>

<div id="exprBox" class="box"></div>
<div id="resultBox" class="box"></div>

<script>
// Affichage KaTeX dans un élément
function katexDisplay(elem, latex) {
    elem.innerHTML = "";
    katex.render(latex, elem, { throwOnError: false });
}

function compute() {
    const a = document.getElementById("aVal").value.trim();
    const b = document.getElementById("bVal").value.trim();
    const alpha = document.getElementById("alphaVal").value.trim();

    const exprBox = document.getElementById("exprBox");
    const resultBox = document.getElementById("resultBox");

    try {
        if (!a || !b || !alpha) {
            resultBox.innerHTML = "<span style='color:red'>Merci de remplir a, b et α.</span>";
            return;
        }

        // Expression en texte pour Nerdamer
        const expr = `sqrt( (${a})^2 + (${b})^2 - 2*(${a})*(${b})*cos(${alpha}) )`;

        // Calcul symbolique et simplification
        const resultExpr = nerdamer(expr).simplify(); // Expression
        const resultStr = resultExpr.toString();      // Texte (ex : 5*sqrt(5 - sqrt(5)))

        // Conversion en LaTeX via l’API globale
        const latexExpr   = nerdamer.convertToLaTeX(expr);
        const latexResult = nerdamer.convertToLaTeX(resultStr);

        // Affichage de l’expression avec les valeurs
        katexDisplay(
            exprBox,
            `\\text{Expression : }\\quad ${latexExpr}`
        );

        // Affichage du résultat symbolique
        katexDisplay(
            resultBox,
            `\\text{Résultat : }\\quad ${latexResult}`
        );
    }
    catch (e) {
        resultBox.innerHTML = "<span style='color:red'>Erreur : " + e.message + "</span>";
    }
}
</script>

</body>
</html>
